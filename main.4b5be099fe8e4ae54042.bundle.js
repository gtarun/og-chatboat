webpackJsonp([0,3],{401:function(e,t){function o(e){throw new Error("Cannot find module '"+e+"'.")}o.keys=function(){return[]},o.resolve=o,e.exports=o,o.id=401},402:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=(o(512),o(488)),a=o(1),s=o(511),r=o(509);s.a.production&&o.i(a.enableProdMode)(),o.i(n.a)().bootstrapModule(r.a)},508:function(e,t,o){"use strict";var n=o(1);o.d(t,"a",function(){return r});var a=this&&this.__decorate||function(e,t,o,n){var a,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(r=(s<3?a(r):s>3?a(t,o,r):a(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},r=function(){function e(){}return e=a([o.i(n.Component)({selector:"app-root",template:o(667)}),s("design:paramtypes",[])],e)}()},509:function(e,t,o){"use strict";var n=o(217),a=o(1),s=o(479),r=o(315),c=o(508),i=o(510);o.d(t,"a",function(){return l});var p=this&&this.__decorate||function(e,t,o,n){var a,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(r=(s<3?a(r):s>3?a(t,o,r):a(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},l=function(){function e(){}return e=p([o.i(a.NgModule)({declarations:[c.a,i.a],imports:[n.a,s.a,r.a],providers:[],bootstrap:[c.a]}),u("design:paramtypes",[])],e)}()},510:function(e,t,o){"use strict";var n=o(1),a=o(664),s=(o.n(a),o(315)),r=o(670);o.n(r);o.d(t,"a",function(){return p});var c=this&&this.__decorate||function(e,t,o,n){var a,s=arguments.length,r=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)r=Reflect.decorate(e,t,o,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(r=(s<3?a(r):s>3?a(t,o,r):a(t,o))||r);return s>3&&r&&Object.defineProperty(t,o,r),r},i=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},p=function(){function e(e,t){this.fb=e,this.http=t,this.showDiv=!1,this.tok="",this.apppId="792069617611842",this.pageId="",this.pageToken="",this.accessToken="792069617611842|vuCRMvbZcZhv0OslCzkpoTgCUqQ",this.pageSubscribeUrl="",this.user_pages=[],this.user_label_share=[],this.facebookLogBtn=!0,this.routeRoot="https://og-chat-bot.herokuapp.com/";var o={appId:this.apppId,xfbml:!0,version:"v2.8"};this.fb.init(o)}return e.prototype.ngOnInit=function(){},e.prototype.loginFb=function(){var e=this;this.fb.login({scope:"email, manage_pages, read_page_mailboxes,publish_pages, pages_messaging"}).then(function(t){e.facebookLogBtn=!1;var o="https://graph.facebook.com/"+t.authResponse.userID+"/accounts?access_token="+t.authResponse.accessToken;console.log("User Access Token: ",t.authResponse.userID,t.authResponse.accessToken),e.http.get(o).map(function(e,t){return e.json()}).catch(function(e){return e.json()}).subscribe(function(t){console.log("Data are: ",t),e.showDiv=!0,e.user_pages=t.data,e.user_pages.forEach(function(t){e.user_label_share.push(!1)}),console.log("User Label: ",e.user_label_share)},function(t){console.log("Error Are: ",t),e.showDiv=!1})},function(e){return console.error(e)})},e.prototype.connectPage=function(e,t){var o=this;console.log("Select Page is: ",e.name,e.id,t),console.log("Page Subscribe Url: ",this.pageSubscribeUrl),this.pageToken=e.access_token,this.pageId=e.id;var n=this.accessToken;this.pageSubscribeUrl="https://graph.facebook.com/v2.8/me/subscribed_apps?access_token="+this.pageToken;var a="https://graph.facebook.com/"+this.pageId+"/subscriptions?object=page&callback_url="+this.routeRoot+"/api/v1/messenger/userwebhook&fields=messages&verify_token=outgrow_messanger_bot_verify_code_user&access_token="+n;console.log("URL IS: ",a),this.http.post(a,{}).subscribe(function(e){console.log("Webhook Subscribed Data: ",e),o.http.post(o.pageSubscribeUrl,{}).subscribe(function(e){console.log("Page Subscribe Data: ",e);var n=new s.b;n.append("Content-Type","application/json");var a="https://graph.facebook.com/v2.8/"+o.pageId+"/thread_settings?access_token="+o.pageToken,r={setting_type:"call_to_actions",thread_state:"new_thread",call_to_actions:[{payload:"Start Now"}]};o.http.post(a,r,{headers:n}).subscribe(function(e){console.log("Start Button: ",e);var n=new s.b;n.append("Content-Type","application/json");var a={page_id:o.pageId,accessToken:o.pageToken};o.http.post(o.routeRoot+"/api/v1/messenger/pageinfo",a,{headers:n}).subscribe(function(e){o.user_label_share[t]=!0,console.log("Access token and Page Id Send")},function(e){return console.log("AccessToken and PageId Not Send",e)})},function(e){console.log("Get Start Error: ",e)})},function(e){return console.log("Page Subscribe Error: ",e)})},function(e){console.log("Webhook Subscribed Error: ",e)})},e.prototype.openWindow=function(){window.open("https://www.facebook.com/pages","_blank","location=yes,height=570,width=520,scrollbars=yes,status=yes")},e=c([o.i(n.Component)({selector:"app-facebook-app",template:o(668),providers:[a.FacebookService]}),i("design:paramtypes",["function"==typeof(t=void 0!==a.FacebookService&&a.FacebookService)&&t||Object,"function"==typeof(r=void 0!==s.c&&s.c)&&r||Object])],e);var t,r}()},511:function(e,t,o){"use strict";o.d(t,"a",function(){return n});var n={production:!0}},512:function(e,t,o){"use strict";var n=o(526),a=(o.n(n),o(519)),s=(o.n(a),o(515)),r=(o.n(s),o(521)),c=(o.n(r),o(520)),i=(o.n(c),o(518)),p=(o.n(i),o(517)),u=(o.n(p),o(525)),l=(o.n(u),o(514)),f=(o.n(l),o(513)),b=(o.n(f),o(523)),h=(o.n(b),o(516)),g=(o.n(h),o(524)),d=(o.n(g),o(522)),v=(o.n(d),o(527)),_=(o.n(v),o(942));o.n(_)},667:function(e,t){e.exports='<div style="margin-left: 5%; margin-top: 5%;">\r\n  <app-facebook-app></app-facebook-app>\r\n</div>\r\n'},668:function(e,t){e.exports='<button class="btn btn-primary" (click)="loginFb()" *ngIf="facebookLogBtn">Facebook Login</button>\r\n<div *ngIf="showDiv" style="margin-left: 10%; width: 80%;">\r\n    <div *ngFor="let item of user_pages; let i = index;">\r\n        <div class="alert alert-info" style="margin-top: 1%;height: auto;">\r\n            <button class="btn btn-primary">{{item.name}}</button>\r\n            <button class="btn btn-primary" (click)="connectPage(item, i);" *ngIf="!user_label_share[i]">Connect</button>\r\n            <h5 style="display: inline; padding-left: 2%;"><a style="color: black;" target="-blank" href="https://www.messenger.com/t/{{item.id}}" *ngIf="user_label_share[i]">Share Link: https://www.messenger.com/t/{{item.id}}</a></h5>\r\n        </div>\r\n    </div>\r\n    <button class="btn btn-primary" (click)="openWindow()">Create New Page</button>\r\n</div>'},943:function(e,t,o){e.exports=o(402)}},[943]);